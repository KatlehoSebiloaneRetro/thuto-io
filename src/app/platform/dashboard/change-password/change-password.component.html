<div class="change-password-container">
    <div class="header">
        <h1>Change Password</h1>
        <button 
            tuiIconButton 
            type="button" 
            icon="tuiIconArrowLeft" 
            appearance="flat" 
            class="back-button" 
            (click)="goBackToSettings()">
        </button>
    </div>

    <!-- Loading spinner -->
    <tui-loader 
        [showLoader]="isLoading" 
        [overlay]="true"
        class="loader-container">
        
        <div class="form-container">
            <div class="form-description">
                <p>Change your account password by filling out the form below.</p>
                <p>Your new password must be at least 8 characters and include a mix of letters, numbers, and special characters.</p>
            </div>

            <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()" class="password-form">
                <!-- Current Password Field -->
                <div class="form-field">
                    <label for="currentPassword">Current Password</label>
                    <tui-input-password
                        formControlName="currentPassword" 
                        tuiTextfieldSize="m"
                        [tuiTextfieldCleaner]="true"
                        [tuiTextfieldLabelOutside]="true">
                        Current Password
                        <input 
                            tuiTextfield 
                            id="currentPassword"
                            autocomplete="current-password" />
                    </tui-input-password>
                    <div class="error-message" *ngIf="getErrorMessage('currentPassword')">
                        {{ getErrorMessage('currentPassword') }}
                    </div>
                </div>

                <!-- New Password Field -->
                <div class="form-field">
                    <label for="newPassword">New Password</label>
                    <tui-input-password
                        formControlName="newPassword" 
                        tuiTextfieldSize="m"
                        [tuiTextfieldCleaner]="true"
                        [tuiTextfieldLabelOutside]="true">
                        New Password
                        <input 
                            tuiTextfield 
                            id="newPassword"
                            autocomplete="new-password" />
                    </tui-input-password>
                    <div class="error-message" *ngIf="getErrorMessage('newPassword')">
                        {{ getErrorMessage('newPassword') }}
                    </div>
                </div>

                <!-- Confirm Password Field -->
                <div class="form-field">
                    <label for="confirmPassword">Confirm New Password</label>
                    <tui-input-password
                        formControlName="confirmPassword" 
                        tuiTextfieldSize="m"
                        [tuiTextfieldCleaner]="true"
                        [tuiTextfieldLabelOutside]="true">
                        Confirm New Password
                        <input 
                            tuiTextfield 
                            id="confirmPassword"
                            autocomplete="new-password" />
                    </tui-input-password>
                    <div class="error-message" *ngIf="getErrorMessage('confirmPassword')">
                        {{ getErrorMessage('confirmPassword') }}
                    </div>
                    <div class="error-message" *ngIf="hasFormError('passwordMismatch')">
                        Passwords do not match
                    </div>
                </div>

                <!-- Password Security Tips -->
                <div class="password-tips">
                    <h3>For a strong password:</h3>
                    <ul>
                        <li>Use at least 8 characters</li>
                        <li>Include uppercase letters (A-Z)</li>
                        <li>Include lowercase letters (a-z)</li>
                        <li>Include numbers (0-9)</li>
                        <li>Include special characters (!#$%^&*)</li>
                    </ul>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button
                        tuiButton
                        type="button"
                        appearance="outline"
                        class="cancel-button"
                        (click)="goBackToSettings()">
                        Cancel
                    </button>
                    <button
                        tuiButton
                        type="submit"
                        appearance="primary"
                        class="submit-button"
                        [disabled]="isLoading">
                        Change Password
                    </button>
                </div>
            </form>
        </div>
    </tui-loader>
</div>